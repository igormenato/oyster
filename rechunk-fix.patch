From cae08cd5bdea8543f438e89fa89b18f526e45322 Mon Sep 17 00:00:00 2001
From: "copilot-swe-agent[bot]" <198982749+Copilot@users.noreply.github.com>
Date: Thu, 15 Jan 2026 00:55:37 +0000
Subject: [PATCH] fix: use containers-storage prefix for rechunk command

The rechunk step was failing because podman was trying to pull the image
from a docker registry at localhost instead of using the local container
storage. This fix adds the 'containers-storage:' prefix to the image
reference so podman correctly uses the locally built image.

Fixes workflow error: 'dial tcp [::1]:443: connect: connection refused'

Co-authored-by: igormenato <42696873+igormenato@users.noreply.github.com>
---
 .github/workflows/build.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml
index c2c6d61..61159b2 100644
--- a/.github/workflows/build.yml
+++ b/.github/workflows/build.yml
@@ -131,7 +131,7 @@ jobs:
           sudo podman run --rm --privileged \
             -v /var/lib/containers:/var/lib/containers \
             --entrypoint /usr/libexec/bootc-base-imagectl \
-            "localhost/${IMAGE_NAME}:${DEFAULT_TAG}" \
+            "containers-storage:localhost/${IMAGE_NAME}:${DEFAULT_TAG}" \
             rechunk --max-layers 96 \
             "containers-storage:localhost/${IMAGE_NAME}:${DEFAULT_TAG}" \
             "containers-storage:localhost/${IMAGE_NAME}:${DEFAULT_TAG}"
-- 
2.52.0

